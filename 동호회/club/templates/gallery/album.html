{% extends 'base.html' %}

{% block title %}{{ album.title }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h3><i class="bi bi-images"></i> {{ album.title }}</h3>
        {% if album.description %}
        <p class="text-muted">{{ album.description }}</p>
        {% endif %}
    </div>
    <div>
        <a href="{{ url_for('gallery.upload_photos', album_id=album.id) }}" class="btn btn-primary">
            <i class="bi bi-upload"></i> 사진 업로드
        </a>
        {% if current_user.is_staff() %}
        <form action="{{ url_for('gallery.delete_album', album_id=album.id) }}" method="POST" class="d-inline" onsubmit="return confirm('앨범을 삭제하시겠습니까? 모든 사진도 함께 삭제됩니다.');">
            <button type="submit" class="btn btn-outline-danger">
                <i class="bi bi-trash"></i> 앨범 삭제
            </button>
        </form>
        {% endif %}
    </div>
</div>

<div class="row g-3">
    {% for photo in photos %}
    <div class="col-6 col-md-4 col-lg-3">
        <div class="card">
            <a href="{{ url_for('static', filename=photo.file_path) }}" target="_blank">
                <img src="{{ url_for('static', filename=photo.file_path) }}" class="card-img-top" alt="사진" style="height: 180px; object-fit: cover;">
            </a>
            <div class="card-body p-2">
                <small class="text-muted">{{ photo.uploader.nickname }} | {{ photo.uploaded_at.strftime('%m/%d') }}</small>
                {% if photo.user_id == current_user.id or current_user.is_staff() %}
                <form action="{{ url_for('gallery.delete_photo', photo_id=photo.id) }}" method="POST" class="mt-1" onsubmit="return confirm('사진을 삭제하시겠습니까?');">
                    <button type="submit" class="btn btn-sm btn-link text-danger p-0">삭제</button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
    {% else %}
    <div class="col-12">
        <div class="text-center text-muted py-5">
            <i class="bi bi-image" style="font-size: 4rem;"></i>
            <p class="mt-3">사진이 없습니다.</p>
        </div>
    </div>
    {% endfor %}
</div>

<div class="mt-4">
    <a href="{{ url_for('gallery.index') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> 앨범 목록
    </a>
</div>
{% endblock %}
